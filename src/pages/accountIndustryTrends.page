<apex:page sidebar="false" controller="accountIndustryTrendsNew" tabStyle="Strategic_Client_Plan__tab">
	
	<c:SCPMenu ></c:SCPMenu>
	
	
	<style>
		.label-link a {
			color: white;
		}
		    
	    .inlineEditUndo {
	    	display: none;
	    }
	    
	    .inlineEditLockOn:hover {
		    background: rgba(0, 0, 0, 0) url("/img/func_icons/util/lock12.gif") no-repeat scroll right 2px;
		}
		.inlineEditWriteOn {
		    background: rgba(0, 0, 0, 0) url("/img/func_icons/util/pencil12.gif") no-repeat scroll right 2px;		    
		}
        
		.pbSubheader h3 {
			display: inline;
			margin-left: 5px;
			font-weight: bold;
		}
		
        .NotUsed{
        background-color: #FF2D2D ! important;
        }
        
        .hasPotentialBussiness {
        background-color: #3796F7 ! important;    
        }
        
        .hasOpportunity {
        background-color: #128E2C ! important;        
        }
             
        .vendidoEnElPasado{
        background-color: #FFC200 ! important;
        }
        
        .noAplica{
        background-color: #808080 ! important;
        }
        
        .hasOpportunityAndPotencial{
        background: #3796F7 ; 
        background-color: #128E2C  ! important;
        //background: linear-gradient(#3796F7, #37F760);
        }
        
        .pbSubheader.brandTertiaryBgr.first.tertiaryPalette {
        	background-color: transparent;
            border-width: 2px 0 0;
            border-style: solid;
            color: #27282e;
            padding: 4px 3px;
        }
        

        .hideListButton.hideShowSection {
        	background: transparent url('/img/alohaSkin/twisty_sprite.png') 0 -11px no-repeat;
            padding-top: 13px;
            margin-top: -8px;
        }
        
        .hideShowSection.showListButton {
        	background: transparent url('/img/alohaSkin/twisty_sprite.png') 0 0 no-repeat;
            padding-top: 13px;
            margin-top: -8px;
        }
        
		.separator {
			width: 100%;
			margin-top: 50px;
		}

        #icons-table {
            width:100%;
        }

        #icons-table td {
            text-align: center;            
            max-width: 90px;
            vertical-align: top;
            padding-top: 5px;
            border: 0px solid #539fc6;
        }

        #icons-table td.selected {
            border: 2px solid #539fc6;
        }    

        #solTable td.itemSelected {
        border: 2px solid #539fc6;
        border-style:double;
        } 
        
        .icon-sectors {
            width: 90px;
            cursor: pointer;
        }

        .hiddenTable {
        display: none;
        }

        .solutionTable th {
            vertical-align: top ! important;
            white-space: normal ! important;
        }
        
        .solucionItems{
            padding:inherit;
            text-align: center;
            border-radius: 11px;
            margin-bottom: 2px;
        }
		
        div.divS{
        border: 2px solid #539fc6 !important;
        }
        
        div.bordesSinColor{
        border: 2px solid #FFFFFF;
        margin: 1% 0% 1% 0%;
        }
        
        div.igualdadDeAltura{
        padding-bottom: 1000px;
        margin-bottom: -1000px;
        }
        
        .espacioVacio{
        margin-bottom: 2px;
        }
	</style>
	<script  type="text/javascript">
		$j = jQuery.noConflict();
		
		$j(document).ready(function() {
			var i = 1;
				$j(".linkSpan").each(function( index ) {
				var link = $j("a",$j(this));				
				link.html("Opp" + i);
				i++;       
			});
			$j(".linkSpan").css("visibility","visible"); 
            
            
            //ajusta los tamañanos de los divs segun cual es el mayor.
            $j("#hidden-Sol").click(function(){
                var maxHeight = 0;
                var height = 0;
                $j(".solucionItems").each(function(){
                    height = $j(this).height();
                    if (height > maxHeight) { maxHeight = height; }
                });
                
                $j(".solucionItems").height(maxHeight);
                
                
                $j(".oportunidadASeleccionar").each(function(){
                    var altura = $j(this).height();
                    //por algun motivo el height() le resta 4 a la altura verdadera.
                    var cantidadDeSoluciones = (altura+4)/27;
                    $j(this).height((cantidadDeSoluciones*maxHeight)+4);
                });
                
            });
            
            //segunda opp
            //o algo asi.
            /*
            var cantidadDeFilas = $j(".solucionItems").size()/4 // esto es la cantidad de filas por que cada fila tiene 4 divs
            
            for(var i == 0; i<cantidadDeFilas; i++){
            	var maxHeight = 0;
                var height = 0;
                
                $j(".Fila"+i).each(function(){
                    var altura = $j(this).height();
                      height = $j(this).height();
                      if (height > maxHeight) { maxHeight = height; }
                });
                
                $j(".Fila"+i).height(maxHeight);
            }
            */
            //falta generar la clase fila con el numero dependiendo de que fila es.
            //a ver 
            
	        $j(".showMore").click(function(){
            	var gparent = $j(this).parent().parent();
            	$j(".lessSpan", gparent).fadeOut(function(){
            		$j(".moreSpan", gparent).fadeIn();
            	});            	 
            });
            $j(".showLess").click(function(){
            	var gparent = $j(this).parent().parent();
            	$j(".moreSpan", gparent).fadeOut(function(){
            		$j(".lessSpan", gparent).fadeIn();
            	});            	 
            });
            
            $j(".hideShowSection").click(function(){
	    		var grparent = $j(this).parent().parent();
	    		
	    		if ($j(this).hasClass("hideListButton")) {
	    			$j(".pbSubsection", grparent).css("display","none");
	    			$j(this).removeClass("hideListButton");
	    			$j(this).addClass("showListButton");
	    		} else {
	    			$j(".pbSubsection", grparent).css("display","block");
	    			$j(this).removeClass("showListButton");
	    			$j(this).addClass("hideListButton");
	    		}
	    	});
            
            $j(".icon-sectors").click(function(){
                
                var parent = $j(this).parent();
                var table = $j("."+parent.attr("id"));
                if (table.css("display") == "block") {
                    table.fadeOut();
                    parent.removeClass('selected');
                } else {
                    table.fadeIn();
                    parent.addClass('selected');
                }
            });    
            
            
            $j(".necesidadASeleccionar").click(function(){
                
                var necesidad = $j(this); 
                var td = $j("."+necesidad.attr("id"));

                if (td.css("display") == "block") {
                    
                    td.fadeOut();
					
                    td.each(function() {
                        var oportunidad = $j(this); 
                        var tdOportunidad = $j("."+oportunidad.attr("id"));
                        if (oportunidad.children().hasClass('divS')) {
                            tdOportunidad.fadeOut();
                            oportunidad.children().removeClass('divS');
                        } 
                    });
                    
                    necesidad.removeClass('itemSelected');                 
                } else {
                    td.fadeIn();
                    necesidad.addClass('itemSelected');
                }
            });
            
            $j(".oportunidadASeleccionar").click(function(){
                
                var oportunidad = $j(this); 
                var td = $j("."+oportunidad.attr("id"));
                if (td.css("display") == "block") {
                    td.fadeOut();
                    oportunidad.removeClass('divS');
                } else {
                    td.fadeIn();
                    oportunidad.addClass('divS');
                }
                
                var maxHeight = 0;
                var height = 0;
                $j(".solucionItems").each(function(){
                    height = $j(this).height();
                    if (height > maxHeight) { maxHeight = height; }
                });
                
                $j(".solucionItems").height(maxHeight);
				
                //tamaño de los espacios vacios
				$j(".espacioVacio").each(function(){
                    var minHeightDefault = $j(this).height();
                    $j(this).css("min-height",minHeightDefault);
                });
                
            });

		});
	</script>
	
	<apex:outputpanel styleClass="container-fluid bootstrap-sf1" id="pageContent">
		<div class="panel panel-default">
			<div class="panel-heading">
				<h2 class="panel-title">
					<span style="float:left; margin-right: 5px;">
						{!$Label.certa_scp__trend}
					</span>
					<c:tutorial />
					<span style="float:left;">
    					<c:showVideo />
    				</span>
                </h2>
				<div class="row paddingRight">
					<div class="btn-group pull-right" role="group" aria-label="...">	    					
						<apex:form >
							<apex:actionFunction action="{!exportToExcel}" name="exportToExcel"/>
						</apex:form>
                        <button type="button" class="btn btn-default btn-sm" onclick="SaveChanges()">
                            <span class="glyphicon glyphicon-floppy-disk icon-btn-left"></span>&nbsp;{!$Label.save}
                        </button>
						<button type="button" class="btn btn-default btn-sm" onclick="exportToExcel()">
							<span class="glyphicon glyphicon-file icon-btn-left"></span>&nbsp;{!$Label.Export_to_Excel}
						</button>
					</div>
				</div>
                <span style="font-size: 11pt; font-weight: bold;">
                    {!$ObjectType.Account.fields.industry.Label}: {!account.industry} - {!$ObjectType.Account.fields.Micro_Industry__c.Label}: {!account.Micro_Industry__c}
                </span>
			</div>    		
			<div class="panel-body">
                <table id="icons-table">
                    <tr>
                        <td id="hidden-Con">
                            <apex:image url="{!$Resource.contexto}" styleClass="icon-sectors"/>
                            <h2>{!$Label.certa_scp__contexto_general}</h2>
                        </td>
                        <td id="hidden-Mét">
                            <apex:image url="{!$Resource.metricas}" styleClass="icon-sectors"/>
                            <h2>{!$Label.certa_scp__metricas_y_analisis_del_mercado}</h2>
                        </td>
                        <td id="hidden-Pla">
                            <apex:image url="{!$Resource.players}" styleClass="icon-sectors"/>
                            <h2>{!$Label.certa_scp__principales_players}</h2>
                        </td>
                        <td id="hidden-Cad">
                            <apex:image url="{!$Resource.cadena}" styleClass="icon-sectors"/>
                            <h2>{!$Label.certa_scp__cadena_de_valor_y_procesos}</h2>
                        </td>
                        <td id="hidden-Ten">
                            <apex:image url="{!$Resource.tendencias}" styleClass="icon-sectors"/>
                            <h2>{!$Label.certa_scp__tendencias}</h2>
                        </td>
                        <td id="hidden-Pri">
                            <apex:image url="{!$Resource.necesidades}" styleClass="icon-sectors"/>
                            <h2>{!$Label.certa_scp__principales_necesidades}</h2>
                        </td>                        
                        <td id="hidden-Opo">
                            <apex:image url="{!$Resource.casos}" styleClass="icon-sectors"/>
                            <h2>{!$Label.certa_scp__oportunidad_sectorial}</h2>
                        </td>
                        <td id="hidden-Sol">
                            <apex:image url="{!$Resource.soluciones}" styleClass="icon-sectors"/>
                            <h2>{!$Label.certa_scp__soluciones}</h2>
                        </td>                      
                    </tr>
                </table>
                <br/><br/>
                <br/><br/>
                <apex:repeat value="{!trendsWrapperList}" var="trendWrapper">					
                    <div class="hiddenTable hidden-{!trendWrapper.typeClass}" >
                        <div class="pbSubheader brandTertiaryBgr first tertiaryPalette">
                            <img src="/s.gif" class="hideListButton hideShowSection" />
                            <h3>{!trendWrapper.type}</h3>
                        </div>
                        <div class="pbSubsection">
                            <apex:outputText rendered="{!trendWrapper.Trends.size > 0}">
                                <table class="table table-striped table-bordered table-condensed">
                                    <thead>
                                        <tr>
                                            <!-- ------------------------------------------------------------------------------ -->
                                            <th style="width:50px;">
                                                <apex:outputText value="{!$Label.certa_scp__numero_de_la_oportunidad}"/>
                                            </th>
                                            <!-- ------------------------------------------------------------------------------ -->
                                            <th style="min-width:230px;max-width:230px;">
                                                <apex:outputText value="{!$ObjectType.Industry_Trend__c.fields.Title__c.Label}"/>
                                            </th>
                                            <!-- ------------------------------------------------------------------------------ -->
                                            <th style="width:100%;">
                                                <apex:outputText value="{!$Label.certa_scp__description}"/>
                                            </th>
                                            <!-- ------------------------------------------------------------------------------ -->
                                            <apex:outputPanel rendered="{!trendWrapper.type == 'Oportunidad Sectorial'}">
                                            <th style="min-width: 200px;">
                                                <apex:outputText value="{!$Label.certa_scp__necesidad}"/>
                                            </th>
                                            </apex:outputPanel>
                                            <!-- ------------------------------------------------------------------------------ -->
                                            <th style="min-width: 80px;max-width: 80px;">
                                                <apex:outputText value="{!$Label.certa_scp__source}"/>
                                            </th>
                                            <!-- ------------------------------------------------------------------------------ -->
                                            <th>
                                                <apex:outputText value="{!$Label.certa_scp__lastmodifieddate}"/>
                                            </th>
                                            <!-- ------------------------------------------------------------------------------ -->
                                        </tr>
                                    </thead>
                                    <!-- ------------------------------------------------------------------------------ -->
                                    <!-- ------------------------------------------------------------------------------ -->
                                    <tbody>
                                        <apex:repeat value="{!trendWrapper.Trends}" var="subitem">                            
                                            <tr>
                                                <!-- ------------------------------------------------------------------------------ -->
                                                <td>
                                                    {!subitem.Name}
                                                </td>
                                                <!-- ------------------------------------------------------------------------------ -->
                                                <td>
                                                    <apex:outputField value="{!subitem.Title__c}  "/>
                                                </td>
                                                <!-- ------------------------------------------------------------------------------ -->
                                                <td>
                                                    
                                                    <span class="lessSpan">
                                                        <apex:outputText rendered="{!LEN(subitem.Trend__c) > 300}" value="{!Left(subitem.Trend__c,300)}"/>
                                                        <apex:outputField rendered="{!LEN(subitem.Trend__c) <= 300}" value="{!subitem.Trend__c}"/>
                                                        <apex:outputText rendered="{!LEN(subitem.Trend__c) > 300}">
                                                            ...
                                                            <button class="btn btn-default btn-xs showMore" style="float:right;">
                                                                <span class="glyphicon glyphicon-zoom-in icon-btn-left"></span>&nbsp;{!$Label.show_more}
                                                            </button>
                                                        </apex:outputText>
                                                    </span>
                                                    <span class="moreSpan" style="float:right;display:none;">								
                                                        <apex:outputField value="{!subitem.Trend__c}"/>												
                                                        <button class="btn btn-default btn-xs showLess" style="float:right;">
                                                            <span class="glyphicon glyphicon-zoom-out icon-btn-left"></span>&nbsp;{!$Label.show_less}
                                                        </button>
                                                    </span>
                                                </td>
                                                <!-- ------------------------------------------------------------------------------ -->
                                                <apex:outputPanel rendered="{!trendWrapper.type == 'Oportunidad Sectorial'}">
                                                <td>
                                                    <span class="lessSpan">
                                                        <apex:outputText value="{!Left(subitem.RelatedTo__r.Title__c,100)}"/>
                                                        <apex:outputText rendered="{!LEN(subitem.RelatedTo__r.Title__c) > 100}">
                                                            ...
                                                        </apex:outputText>
                                                        <apex:outputText >                                                    
                                                            <button class="btn btn-default btn-xs showMore" style="float:right;">
                                                                <span class="glyphicon glyphicon-zoom-in icon-btn-left"></span>&nbsp;{!$Label.show_more}
                                                            </button>
                                                        </apex:outputText>
                                                    </span>
                                                    <span class="moreSpan" style="display:none;">                               
                                                        <apex:outputField value="{!subitem.RelatedTo__r.Title__c}"/><br/><br/>
                                                        <apex:outputField value="{!subitem.RelatedTo__r.Trend__c}"/>
                                                        <button class="btn btn-default btn-xs showLess" style="float:right;">
                                                            <span class="glyphicon glyphicon-zoom-out icon-btn-left"></span>&nbsp;{!$Label.show_less}
                                                        </button>
                                                    </span>     

                                                </td>
                                                </apex:outputPanel>
                                                <!-- ------------------------------------------------------------------------------ -->
                                                <td>
                                                    <apex:outputText value="{!subitem.Region__r.Name}" />
                                                </td>
                                                <!-- ------------------------------------------------------------------------------ -->
                                                <td style="text-align: center;">
                                                    <apex:outputText value="{0,date,dd'/'MM'/'yyyy}">
                                                        <apex:param value="{!subitem.LastModifiedDate}" /> 
                                                    </apex:outputText>
                                                </td>
                                                <!-- ------------------------------------------------------------------------------ -->
                                            </tr>
                                        </apex:repeat>
                                    </tbody>
                                </table>
                            </apex:outputText>
                            <apex:outputText rendered="{!IF(OR(trendWrapper.Trends == null, trendWrapper.Trends.size == 0) , true , false)}">
                                <table class="table table-striped table-bordered table-condensed">
                                    <tr>
                                        <td>
                                            <apex:outputText value="{!$Label.certa_scp__no_industry_trends}" />
                                        </td>
                                    </tr>
                                </table>	                        
                        </apex:outputText>
                        </div>
                    </div>
                </apex:repeat>
                <!-- ------------------------------------------------------------------------------------- -->
                <!-- ------------------------------------------------------------------------------------- -->
                <!-- tabla soluciones -->
                <apex:form >
                    <div class="hiddenTable hidden-{!Left(SolutionsLabel,3)}">

                        <div class="pbSubheader brandTertiaryBgr first tertiaryPalette">
                            <img src="/s.gif" class="hideListButton hideShowSection" />
                            <h3>{!SolutionsLabel}</h3>
                        </div>
                        <div class="pbSubsection">
                            
                            <!-- codigo de colores -->
                            <div class="alert alert-info" role="alert">	
                                <span class="glyphicon glyphicon-info-sign"></span>	    				
                                <span class="messageText"><span style="font-weight:bold;  margin:5px">{!$Label.Asignacion_de_Soluciones_Para_el_Sector}</span><br/>
                                    
                                    <div class="row">
                                        <div class= "col-md-6">
                                            <span class="NotUsed" style="margin-left:3px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                                            <span class="NotUsedSampleText">{!$Label.no_ha_sido_asignado_a_ninguna_oportunidad}</span><br/>
                                            <span class="hasPotentialBussiness" style="margin-left:3px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                                            <span class="hasPotentialBussinessSampleText">{!$Label.ha_sido_asignado_por_lo_menos_a_una_oportunidad_potencial}</span><br/>
                                            <span class="hasOpportunity" style="margin-left:3px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                                            <span class="hasOpportunitySampleText">{!$Label.ha_sido_asignado_por_lo_menos_a_una_oportunidad_existente}.</span><br/>
                                        </div>
                                        
                                        <div class= "col-md-6">
                                            <span class="vendidoEnElPasado" style="margin-left:3px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                                            <span class="hasOpportunitySampleText">{!$Label.Vendido_en_el_Pasado}.</span><br/>   
                                            <span class="noAplica" style="margin-left:3px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                                            <span class="hasOpportunitySampleText">{!$Label.No_Aplica}.</span>
                                        </div>
                                        
                                    </div>
                                    
                                </span>
                            </div>
                            <!-- ------- -->
                            
                            <apex:outputText rendered="{!Solutions.size > 0}">
                                
                                <table id="solTable" class="table table-bordered table-condensed solutionTable">
                                    <thead>
                                        <tr>
                                            <th style="width: 20%;">
                                                {!$Label.Necesidad_Sectorial}
                                            </th>
                                            <th style="width: 22%;">
                                                {!$Label.Oportunidad_Sectorial}
                                            </th>
                                            <th>
                                                {!$Label.Solucion_Telefonica}
                                            </th>
                                            <th style="width: 13%;">
                                                {!$Label.Oportunidad_Relacionada}
                                            </th>
                                            <th style="width: 11%;">
                                                {!$Label.Estado_Actual}
                                            </th>
                                            <th style="width: 12%;">
                                                {!$Label.Comentarios}
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <apex:repeat value="{!necesidadesWpp}" var="necesidad">
                                            <tr>
                                                <!-- Para ocultar nuevamente este boton alcanza con agregar el hiddenTable nuevamente y sacar el itemSelected -->
                                                <td id="{!necesidad.necesidadId}" class="necesidadASeleccionar itemSelected" style="vertical-align: middle; height: {!necesidad.oportunidades.size * 27}px; text-align: center; cursor: pointer;">
                                                    {!necesidad.necesidad}
                                                </td>
                                                <td>
                                                    <apex:repeat value="{!necesidad.oportunidades}" var="oportunidad">
                                                        <div id="{!oportunidad.oportunidadId}" class="{!oportunidad.necesidadIdPadre} ">
                                                            <div id="{!oportunidad.oportunidadId}" class="bordesSinColor  divS oportunidadASeleccionar" style="height: {!oportunidad.soluciones.size * 27}px; text-align: center; cursor: pointer;">
                                                                {!oportunidad.oportunidad}
                                                            </div>
                                                        </div>    
                                                    </apex:repeat>
                                                </td>
                                                <td>
                                                    <apex:repeat value="{!necesidad.oportunidades}" var="oportunidad">
                                                        <div class="espacioVacio" style="min-height:{!oportunidad.soluciones.size *28}px">
                                                            <apex:repeat value="{!oportunidad.soluciones}" var="solucion">
                                                                <div class="{!solucion.oportunidadIdPadre} ">
                                                                    <div style="min-height: 26px" class="solucionItems {!IF( (solucion.status.Current_state__c == 'Vendido en el pasado'), 'vendidoEnElPasado', (IF(solucion.status.Current_state__c == 'No aplica', 'noAplica' , IF((solucion.Trend.Opportunities__R.size > 0) && (solucion.Trend.Potential_New_Business_Trend__r.size > 0), 'hasOpportunityAndPotencial' , (IF ( solucion.Trend.Opportunities__R.size > 0 , 'hasOpportunity' , IF(solucion.Trend.Potential_New_Business_Trend__r.size > 0 , 'hasPotentialBussiness' , 'NotUsed') ))) )))} ">
                                                                        {!solucion.Trend.Title__c}
                                                                    </div>
                                                                </div>   
                                                            </apex:repeat>
                                                        </div>    
                                                    </apex:repeat>
                                                </td>
                                                <td> 
                                                    <apex:repeat value="{!necesidad.oportunidades}" var="oportunidad">
                                                        <div class="espacioVacio" style="min-height:{!oportunidad.soluciones.size *28}px">
                                                            <apex:repeat value="{!oportunidad.soluciones}" var="solucion">
                                                                <div class="{!solucion.oportunidadIdPadre} ">
                                                                    <div style="min-height: 26px;" class="solucionItems {!IF( (solucion.status.Current_state__c == 'Vendido en el pasado'), 'vendidoEnElPasado', (IF(solucion.status.Current_state__c == 'No aplica', 'noAplica' , IF((solucion.Trend.Opportunities__R.size > 0) && (solucion.Trend.Potential_New_Business_Trend__r.size > 0), 'hasOpportunityAndPotencial' , (IF ( solucion.Trend.Opportunities__R.size > 0 , 'hasOpportunity' , IF(solucion.Trend.Potential_New_Business_Trend__r.size > 0 , 'hasPotentialBussiness' , 'NotUsed') ))) )))}">
                                                                        
                                                                        <apex:repeat value="{!solucion.Trend.Opportunities__R}" var="Opps">                      							
                                                                            <span class="PopupHolderOpp label label-warning label-link" style="width: 74px;  height: 16px;margin: 0 auto;">			                   								
                                                                                <apex:outputText value="{!Left(Opps.Opportunity__r.Name,10)}"/><apex:outputText rendered="{!LEN(Opps.Opportunity__r.Name)>10}" value="..."/>			                   										                   										
                                                                                <div class="individualPalette lookupHoverDetail lookupHoverDetailOverridable" style="display:none; visibility:visible; position:absolute; top:auto; left:auto;">
                                                                                    <div class="Custom50Block topRight">
                                                                                        <div class="bPageBlock secondaryPalette">
                                                                                            <div class="pbHeader">
                                                                                                <table border="0" cellpadding="0" cellspacing="0" style="border-bottom:0px;"><tbody>
                                                                                                    <tr>
                                                                                                        <td class="pbTitle"><h2 class="mainTitle">{!$Label.opportunity}</h2></td>
                                                                                                        <td class="pbButton">
                                                                                                            <a href="/{!Opps.Opportunity__c}">
                                                                                                                <button type="button" class="btn btn-default btn-xs">
                                                                                                                    {!$Label.view}
                                                                                                                </button>		                     
                                                                                                            </a>
                                                                                                        </td>			                                                                
                                                                                                    </tr>
                                                                                                    </tbody></table>
                                                                                            </div>
                                                                                            <div class="pbBody">
                                                                                                <table class="detailList" border="0" cellpadding="0" cellspacing="0" style="border-bottom:0px;"><tbody>
                                                                                                    <tr>
                                                                                                        <td class="labelCol last">{!$ObjectType.Opportunity.fields.Name.Label}:</td>
                                                                                                        <td class="dataCol last">{!Opps.Opportunity__r.Name}</td>
                                                                                                    </tr>
                                                                                                    </tbody></table>
                                                                                            </div>
                                                                                            <div class="pbFooter secondaryPalette">
                                                                                                <div class="bg"></div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </span>
                                                                        </apex:repeat>
                                                                        
                                                                    </div>
                                                                </div>
                                                            </apex:repeat>
                                                        </div>
                                                    </apex:repeat>    
                                                    
                                                </td>
                                                
                                                <!--  padding: 2px;
margin: 2px;-->
                                                <td>
                                                    <apex:repeat value="{!necesidad.oportunidades}" var="oportunidad">
                                                        <div class="espacioVacio" style="min-height:{!oportunidad.soluciones.size *28}px">
                                                            <apex:repeat value="{!oportunidad.soluciones}" var="solucion">
                                                                <div class="{!solucion.oportunidadIdPadre} ">
                                                                    <div style="min-height: 26px; cursor: pointer;" class="solucionItems {!IF( (solucion.status.Current_state__c == 'Vendido en el pasado'), 'vendidoEnElPasado', (IF(solucion.status.Current_state__c == 'No aplica', 'noAplica' , IF((solucion.Trend.Opportunities__R.size > 0) && (solucion.Trend.Potential_New_Business_Trend__r.size > 0), 'hasOpportunityAndPotencial' , (IF ( solucion.Trend.Opportunities__R.size > 0 , 'hasOpportunity' , IF(solucion.Trend.Potential_New_Business_Trend__r.size > 0 , 'hasPotentialBussiness' , 'NotUsed') ))) )))}">
                                                                        
                                                                        <apex:outputField value="{!solucion.Status.Current_state__c}" style="background-color:green" >
                                                                            <apex:inlineEditSupport rendered="{!canEdit}" event="ondblclick" />
                                                                        </apex:outputField> 
                                                                        
                                                                    </div>
                                                                </div>
                                                            </apex:repeat>
                                                        </div>
                                                    </apex:repeat>       
                                                </td>
                                                <td>
                                                    <apex:repeat value="{!necesidad.oportunidades}" var="oportunidad">
                                                        <div class="espacioVacio" style="min-height:{!oportunidad.soluciones.size *28}px">
                                                            <apex:repeat value="{!oportunidad.soluciones}" var="solucion">
                                                                <div class="{!solucion.oportunidadIdPadre} ">
                                                                    <div style="min-height: 26px" class="solucionItems {!IF( (solucion.status.Current_state__c == 'Vendido en el pasado'), 'vendidoEnElPasado', (IF(solucion.status.Current_state__c == 'No aplica', 'noAplica' , IF((solucion.Trend.Opportunities__R.size > 0) && (solucion.Trend.Potential_New_Business_Trend__r.size > 0), 'hasOpportunityAndPotencial' , (IF ( solucion.Trend.Opportunities__R.size > 0 , 'hasOpportunity' , IF(solucion.Trend.Potential_New_Business_Trend__r.size > 0 , 'hasPotentialBussiness' , 'NotUsed') ))) )))}">
                                                                        
                                                                        <apex:outputField value="{!solucion.Trend.Comentarios__c}" style="background-color:green" >
                                                                            <apex:inlineEditSupport rendered="{!canEdit}" event="ondblclick" />
                                                                        </apex:outputField> 
                                                                        
                                                                    </div>
                                                                </div>
                                                            </apex:repeat>
                                                        </div>
                                                    </apex:repeat>    
                                                </td>
                                            </tr>
                                        </apex:repeat>
                                    </tbody>
                                </table>

                            </apex:outputText>
                            <apex:outputText rendered="{!Solutions.size == 0}">
                                <table class="table table-striped table-bordered table-condensed">
                                    <tr>
                                        <td>
                                            <apex:outputText value="{!$Label.certa_scp__no_industry_trends}" />
                                        </td>
                                    </tr>
                                </table>	                        
                            </apex:outputText>
                            
                            <!-- ------------------------------------------------------------------- -->
                            

                            
                        </div>
                        
                    </div>

                    <apex:outputPanel rendered="{!canEdit}">
                        <apex:actionFunction action="{!save}" name="SaveChanges" status="renderMeStatus"/>
                    </apex:outputPanel>
                </apex:form>
                <!-- ------------------------------------------------------------------------------------- -->
                <!-- ------------------------------------------------------------------------------------- -->
			</div>
			<div class="panel-footer">
				<div class="row paddingRight">
					<div class="btn-group pull-right" role="group" aria-label="...">	    					
						<apex:form >
							<apex:actionFunction action="{!exportToExcel}" name="exportToExcel"/>
						</apex:form>
                        <button type="button" class="btn btn-default btn-sm" onclick="SaveChanges()">
                            <span class="glyphicon glyphicon-floppy-disk icon-btn-left"></span>&nbsp;{!$Label.save}
                        </button>
						<button type="button" class="btn btn-default btn-sm" onclick="exportToExcel()">
							<span class="glyphicon glyphicon-file icon-btn-left"></span>&nbsp;{!$Label.Export_to_Excel}
						</button>
					</div>
				</div>
			</div>
			<c:FastTask page="{!$Label.certa_scp__trend}" account="{!account.id}"></c:FastTask>
			<chatter:feed entityId="{!Account.id}" />
		</div>
	</apex:outputpanel>
</apex:page>